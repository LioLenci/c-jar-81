<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500&display=swap" rel="stylesheet">

  <title>Jar of Positivity</title>

  <style>
    :root {
      --bg: #f6f1ec;
      --ink: #2f2f2f;
      --muted: #7a7a7a;
      --glass: rgba(120, 165, 175, 0.18);
      --stroke: rgba(60, 80, 85, 0.55);
      --btnStroke: rgba(0, 0, 0, 0.12);
      --shadow: 0 14px 30px rgba(0, 0, 0, 0.08);

      --sage: #9fb8a0;
      --sageDark: #86a689;
      --sageLight: #b8cfb7;
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      background: radial-gradient(1200px 700px at 50% 10%, #fbf8f5, var(--bg));
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wrap {
      width: min(880px, 92vw);
      text-align: center;
      padding: 34px 10px 48px;
    }

    .hello {
      display: flex;
      justify-content: center;
      margin-bottom: 10px;
      user-select: none;
    }

    .hello svg {
      width: min(520px, 92vw);
      height: auto;
    }

    .helloText {
      font-family: "Dancing Script", "Bradley Hand", "Segoe Print", "Apple Chancery", cursive;
      font-size: 110px;
      fill: rgba(55, 55, 55, 0.72);
    }

    .sub {
      margin: 6px 0 26px;
      color: var(--muted);
      letter-spacing: 0.08em;
      font-size: 13px;
      text-transform: uppercase;
    }

    .stage {
      display: grid;
      place-items: center;
      gap: 14px;
      margin-top: 10px;
    }

    .jarArea {
      position: relative;
      width: min(340px, 80vw);
      aspect-ratio: 1/1.08;
      display: grid;
      place-items: center;
      cursor: pointer;
      outline: none;
    }

    .jarArea:focus-visible {
      box-shadow: 0 0 0 4px rgba(120, 165, 175, 0.28);
      border-radius: 18px;
    }

    /* Ensure the falling note is always on top */
    .jar {
      position: relative;
      z-index: 1;
      width: 100%;
      filter: drop-shadow(0px 18px 18px rgba(0, 0, 0, 0.08));
      transform-origin: 50% 78%;
    }

    .note {
      z-index: 10;
      position: absolute;
      left: 50%;
      top: 14%;
      transform: translate(-50%, -10px) rotate(-2deg);
      width: min(250px, 78%);
      background: #fffdf8;
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 16px 16px 14px;
      opacity: 0;
      pointer-events: none;
    }

    .note .msg {
      font-family: ui-rounded, "Bradley Hand", "Comic Sans MS", "Segoe Print", "Apple Chancery", cursive;
      font-size: 22px;
      line-height: 1.15;
      color: rgba(40, 40, 40, 0.88);
      margin: 0;
    }

    .note .tiny {
      margin-top: 10px;
      font-size: 12px;
      color: rgba(0, 0, 0, 0.35);
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .lid {
      transform-origin: 50% 18%;
      transition: transform 520ms cubic-bezier(.2, .9, .2, 1);
    }

    .shake {
      animation: shake 520ms ease-in-out;
    }

    @keyframes shake {
      0% {
        transform: rotate(0deg)
      }

      20% {
        transform: rotate(-3deg)
      }

      45% {
        transform: rotate(3.5deg)
      }

      70% {
        transform: rotate(-2.5deg)
      }

      100% {
        transform: rotate(0deg)
      }
    }

    .dropIn {
      animation: dropIn 760ms cubic-bezier(.18, .95, .18, 1) forwards;
    }

    @keyframes dropIn {
      0% {
        opacity: 0;
        transform: translate(-50%, -30px) rotate(-3deg) scale(0.98);
      }

      55% {
        opacity: 1;
        transform: translate(-50%, 140px) rotate(2deg) scale(1.01);
      }

      100% {
        opacity: 1;
        transform: translate(-50%, 170px) rotate(1deg) scale(1);
      }
    }

    .hint {
      color: rgba(0, 0, 0, 0.48);
      font-size: 14px;
      margin-top: 2px;
    }

    .controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 8px;
    }

    button {
      appearance: none;
      border: 1px solid var(--btnStroke);
      background: rgba(255, 255, 255, 0.86);
      backdrop-filter: blur(6px);
      color: rgba(20, 20, 20, 0.78);
      padding: 12px 16px;
      border-radius: 999px;
      font-size: 14px;
      letter-spacing: 0.01em;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.06);
      transition: transform 120ms ease, box-shadow 120ms ease;
    }

    button:hover {
      box-shadow: 0 14px 26px rgba(0, 0, 0, 0.08);
    }

    button:active {
      transform: translateY(1px);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    @media (prefers-reduced-motion: reduce) {
      .shake {
        animation: none;
      }

      .dropIn {
        animation: none;
        opacity: 1;
        transform: translate(-50%, 170px) rotate(1deg) scale(1);
      }

      .lid {
        transition: none;
      }
    }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="hello" aria-label="Hi, Charley">
      <svg viewBox="0 0 900 220" role="img" aria-label="Hi, Charley">
        <defs>
          <mask id="revealMask">
            <rect x="0" y="0" width="0" height="220" fill="#fff">
              <animate attributeName="width" from="0" to="900" dur="1.8s" fill="freeze" />
            </rect>
          </mask>
        </defs>
        <text x="50%" y="58%" text-anchor="middle" dominant-baseline="middle" mask="url(#revealMask)" class="helloText">
          Hi, Charley
        </text>
      </svg>
    </div>

    <div class="sub">Jar of positivity</div>

    <section class="stage">
      <div class="jarArea" id="jarArea" tabindex="0" role="button" aria-label="Tap the jar to get a positive note">
        <div class="note" id="note" aria-live="polite">
          <p class="msg" id="msg">You’ve got this.</p>
          <div class="tiny">a little note</div>
        </div>

        <svg class="jar" id="jarSvg" viewBox="0 0 300 330" aria-hidden="true">
          <defs>
            <clipPath id="jarClip">
              <path d="M95 70
                       C95 62, 105 58, 115 58
                       L185 58
                       C195 58, 205 62, 205 70
                       L205 92
                       C205 100, 212 108, 220 118
                       C232 134, 238 158, 238 190
                       L238 248
                       C238 292, 210 312, 150 312
                       C90 312, 62 292, 62 248
                       L62 190
                       C62 158, 68 134, 80 118
                       C88 108, 95 100, 95 92
                       Z" />
            </clipPath>

            <mask id="jarStrokeMask">
              <rect x="0" y="0" width="300" height="330" fill="white" />
              <path d="M68 86
                       C92 76, 120 74, 150 74
                       C180 74, 208 76, 232 86
                       C242 92, 242 114, 232 120
                       C208 130, 180 132, 150 132
                       C120 132, 92 130, 68 120
                       C58 114, 58 92, 68 86 Z" fill="black" />
            </mask>
          </defs>

          <g class="lid" id="lid">
            <rect x="70" y="32" width="160" height="44" rx="14" fill="rgba(120,120,120,0.20)"
              stroke="rgba(60,60,60,0.18)" />
            <rect x="82" y="38" width="136" height="10" rx="5" fill="rgba(255,255,255,0.35)" />
          </g>

          <g id="bow" opacity="0.98">
            <path d="M78 92
                     C96 86, 120 84, 150 84
                     C180 84, 204 86, 222 92
                     C226 94, 226 104, 222 106
                     C204 112, 180 114, 150 114
                     C120 114, 96 112, 78 106
                     C74 104, 74 94, 78 92 Z" fill="var(--sage)" />

            <path d="M86 94
                     C104 90, 124 88, 150 88
                     C176 88, 196 90, 214 94" fill="none" stroke="var(--sageLight)" stroke-width="4"
              stroke-linecap="round" opacity="0.55" />

            <path d="M122 98
                     C92 74, 54 86, 64 114
                     C72 136, 108 132, 132 112
                     C140 106, 138 104, 122 98 Z" fill="var(--sage)" />

            <path d="M178 98
                     C206 78, 240 92, 232 116
                     C224 140, 190 132, 168 112
                     C160 105, 162 104, 178 98 Z" fill="var(--sage)" />

            <ellipse cx="150" cy="102" rx="11" ry="9" fill="var(--sageDark)" opacity="0.95" />
            <path d="M142 102 C146 96, 154 96, 158 102" fill="none" stroke="var(--sageLight)" stroke-width="3.5"
              stroke-linecap="round" opacity="0.5" />

            <path d="M144 110
                     C138 132, 132 148, 134 166
                     C136 178, 152 166, 154 154
                     C156 142, 150 126, 150 114 Z" fill="var(--sage)" opacity="0.92" />
            <path d="M156 110
                     C164 130, 172 150, 170 168
                     C168 180, 148 170, 146 156
                     C144 142, 150 126, 150 114 Z" fill="var(--sage)" opacity="0.88" />

            <path d="M140 164 L150 156 L156 166" fill="none" stroke="rgba(0,0,0,0.08)" stroke-width="3"
              stroke-linecap="round" opacity="0.35" />
            <path d="M160 166 L150 156 L146 168" fill="none" stroke="rgba(0,0,0,0.08)" stroke-width="3"
              stroke-linecap="round" opacity="0.28" />
          </g>

          <!-- Jar body (fill only) -->
          <path d="M95 70
                   C95 62, 105 58, 115 58
                   L185 58
                   C195 58, 205 62, 205 70
                   L205 92
                   C205 100, 212 108, 220 118
                   C232 134, 238 158, 238 190
                   L238 248
                   C238 292, 210 312, 150 312
                   C90 312, 62 292, 62 248
                   L62 190
                   C62 158, 68 134, 80 118
                   C88 108, 95 100, 95 92
                   Z" fill="var(--glass)" />

          <!-- Notes inside jar -->
          <g clip-path="url(#jarClip)" opacity="0.94">
            <rect x="72" y="246" width="98" height="54" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(6 72 246)" />
            <rect x="150" y="248" width="96" height="52" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(-5 150 248)" />
            <rect x="98" y="236" width="110" height="56" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(1 98 236)" />

            <rect x="78" y="214" width="104" height="54" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(-7 78 214)" />
            <rect x="150" y="214" width="104" height="54" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(6 150 214)" />
            <rect x="104" y="202" width="112" height="56" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(2 104 202)" />

            <rect x="80" y="182" width="98" height="52" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(7 80 182)" />
            <rect x="150" y="182" width="100" height="52" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(-6 150 182)" />
            <rect x="102" y="170" width="108" height="54" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(1 102 170)" />

            <rect x="92" y="140" width="86" height="46" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(-8 92 140)" />
            <rect x="142" y="138" width="92" height="48" rx="8" fill="#fffdf8" stroke="rgba(0,0,0,0.05)"
              transform="rotate(7 142 138)" />

            <rect x="88" y="160" width="56" height="26" rx="6" fill="#fffdf8" opacity="0.85" />
            <rect x="170" y="168" width="58" height="26" rx="6" fill="#fffdf8" opacity="0.82" />
            <rect x="118" y="154" width="62" height="28" rx="6" fill="#fffdf8" opacity="0.80" />
          </g>

          <!-- Inner highlights -->
          <path d="M92 130 C84 154, 84 230, 92 268" fill="none" stroke="rgba(255,255,255,0.65)" stroke-width="6"
            stroke-linecap="round" opacity="0.55" />
          <path d="M206 128 C214 160, 214 230, 206 266" fill="none" stroke="rgba(255,255,255,0.45)" stroke-width="4"
            stroke-linecap="round" opacity="0.38" />

          <!-- Jar outline (masked under bow) -->
          <path d="M95 70
                   C95 62, 105 58, 115 58
                   L185 58
                   C195 58, 205 62, 205 70
                   L205 92
                   C205 100, 212 108, 220 118
                   C232 134, 238 158, 238 190
                   L238 248
                   C238 292, 210 312, 150 312
                   C90 312, 62 292, 62 248
                   L62 190
                   C62 158, 68 134, 80 118
                   C88 108, 95 100, 95 92
                   Z" fill="none" stroke="var(--stroke)" stroke-width="3" mask="url(#jarStrokeMask)" />

          <ellipse cx="150" cy="312" rx="84" ry="10" fill="rgba(0,0,0,0.06)" />
        </svg>
      </div>

      <div class="hint" id="hint">Tap the jar</div>

      <div class="controls">
        <button type="button" id="newBtn">New note</button>
      </div>

      <span class="sr-only" id="srStatus" aria-live="polite"></span>
    </section>
  </main>

  <script>
    // Regular notes (70-ish)
    const MESSAGES = [
      "You are worthy of the life you desire.",
      "One small step is still progress.",
      "You’ve made it through hard days before.",
      "Only in darkness can you see the stars.",
      "You don’t have to earn rest.",
      "You are allowed to take up space.",
      "This moment is enough.",
      "I see how bright you shine.",
      "You deserve all the good things you receive.",
      "I’m really glad you exist.",
      "I can’t see you, but I know you look great today.",

      // Gentle grounding
      "It’s okay to go slowly today.",
      "You don’t have to solve everything right now.",
      "Take a breath. Then another.",
      "You’re allowed to pause here.",
      "Nothing needs to be perfect.",
      "You can put some of it down.",
      "You’re doing enough for today.",
      "This is allowed to be easy.",
      "You don’t have to rush this.",
      "You can let today be gentle.",

      // Quiet confidence
      "You’re stronger than you feel.",
      "You know more than you think.",
      "You can trust yourself.",
      "You handle things with care.",
      "You’re learning what works for you.",
      "You adapt beautifully.",
      "You’re allowed to be proud.",
      "You don’t need permission to be yourself.",
      "You show up honestly — that matters.",
      "Your way is valid.",

      // Warm + human
      "You make things feel lighter.",
      "People feel calmer around you.",
      "You have a good heart.",
      "You bring sincerity with you.",
      "You don’t try to be someone else — and that’s rare.",
      "You notice things other people miss.",
      "You’re easy to appreciate.",
      "You’re allowed to feel good today.",
      "You don’t have to prove anything.",
      "You’re enough, even on quiet days.",

      // Soft encouragement
      "You can take this one step at a time.",
      "It’s okay if today feels tender.",
      "You’re allowed to ask for help.",
      "You’re not behind.",
      "You’re allowed to change your mind.",
      "You can begin again whenever you want.",
      "You don’t owe anyone more than honesty.",
      "You’re doing the best you can.",
      "You’re allowed to feel hopeful.",
      "You’re allowed to rest here."
    ];

    // Easter eggs (rare + personal)
    const EASTER_EGGS = [
      "Every room is brighter when you smile.",
      "Georgie thinks you’re doing great.",
      "Some people just feel like home.",
      "This note is smiling at you.",
      "You make every day brighter than the last.",
      "You’re easy to care about.",
      "I’m probably thinking of you right now.",
      "I hope something makes you smile today.",
      "Your eyes are my favorite shade of blue."
    ];

    // --- helpers ---
    function clean(list) {
      return list.map(s => (s ?? "").toString().trim()).filter(Boolean);
    }

    function makeBagPicker(list) {
      let bag = [];
      return function pick() {
        if (bag.length === 0) bag = [...list];
        const i = Math.floor(Math.random() * bag.length);
        return bag.splice(i, 1)[0];
      };
    }

    const CLEAN_MESSAGES = clean(MESSAGES);
    const CLEAN_EASTER = clean(EASTER_EGGS);

    const pickMessage = makeBagPicker(CLEAN_MESSAGES);
    const pickEaster = makeBagPicker(CLEAN_EASTER);

    function getRandomMessage() {
      // ~1 in 8 chance for Easter egg (adjust if you want rarer: 0.08, more common: 0.15)
      const showEasterEgg = CLEAN_EASTER.length > 0 && Math.random() < 0.125;
      return showEasterEgg ? pickEaster() : pickMessage();
    }

    // --- elements ---
    const jarArea = document.getElementById('jarArea');
    const jarSvg = document.getElementById('jarSvg');
    const lid = document.getElementById('lid');
    const note = document.getElementById('note');
    const msgEl = document.getElementById('msg');
    const hint = document.getElementById('hint');
    const btn = document.getElementById('newBtn');
    const sr = document.getElementById('srStatus');

    let busy = false;

    // Guaranteed animation restart every time
    function restartShake() {
      jarSvg.classList.remove('shake');
      void jarSvg.getBoundingClientRect(); // force reflow
      jarSvg.classList.add('shake');
    }

    function play() {
      if (busy) return;
      busy = true;

      // reset note animation
      note.classList.remove('dropIn');
      note.style.opacity = 0;

      // ALWAYS shake
      restartShake();

      // pop lid a bit during shake
      lid.style.transform = 'translateY(-12px) rotate(-5deg)';

      const text = getRandomMessage();
      msgEl.textContent = text;
      sr.textContent = text;

      hint.textContent = "…";

      setTimeout(() => {
        note.classList.add('dropIn');
      }, 260);

      setTimeout(() => {
        lid.style.transform = 'translateY(0px) rotate(0deg)';
        hint.textContent = "Tap again or press “New note”";
        busy = false;
      }, 900);
    }

    jarArea.addEventListener('click', play);
    jarArea.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); play(); }
    });
    btn.addEventListener('click', play);
  </script>

</body>

</html>